!function(a,b){"use strict";var c=function(){return this.init.apply(this,arguments)};c.prototype={constructor:c,_rHash:/#/,_rHTTPs:/^http[s]?:\/\/.*?\//,_enabled:!1,_pushable:"history"in a&&"pushState"in a.history,_hashable:"onhashchange"in a,_ishashpushed:!1,_uid:0,_states:{},_responses:{},_callbacks:{pop:[],before:[],after:[]},_async:!0,_caching:!0,init:function(c){var d=a.location.href;this._states[d]={uid:this._getUid(),cached:!1},c.async!==b&&(this._async=c.async),c.caching!==b&&(this._caching=c.caching),this._stateEnable()},push:function(a,b){var c=this;this._fire("before"),this._stateCached(a)?(this._push(a),b(this._responses[a])):(this._states[a]={uid:this._getUid(),cached:!1},this._async?this._getUrl(a,function(d){c._push(a),c._fire("after",d),"function"==typeof b&&b(d)}):(this._push(a),this._fire("after"),"function"==typeof b&&b()))},onBeforeState:function(a){this._bind("before",a)},onAfterState:function(a){this._bind("after",a)},onPopState:function(a){this._bind("pop",a)},goBack:function(){this._history.back(),this._fire("back")},goForward:function(){this._history.forward(),this._fire("forward")},_push:function(b){this._pushable?a.history.pushState(this._states[b],"",b):(this._ishashpushed=!0,a.location.hash=b.replace(this._rHTTPs,""))},_stateCached:function(a){var b=!1;return this._caching&&this._states[a]&&this._states[a].cached&&this._responses[a]&&(b=!0),b},_cacheState:function(a,b){this._caching&&(this._states[a].cached=!0,this._responses[a]=b)},_getUid:function(){return this._uid=this._uid+1,this._uid},_getUrl:function(a,b){var c=new XMLHttpRequest,d=this;c.open("GET",a,!0),c.onreadystatechange=function(){if(4===this.readyState&&200===this.status)try{d._cacheState(a,this),"function"==typeof b&&b(this)}catch(c){}},c.send()},_bind:function(a,b){this._callbacks[a]&&"function"==typeof b&&this._callbacks[a].push(b)},_fire:function(a){for(var b=this._callbacks[a].length;b--;)this._callbacks[a][b].apply(this,[].slice.call(arguments,1))},_stateEnable:function(){if(this._enabled)return this;var b=this,c=function(){var c=a.location.href.replace(b._rHash,"/");b._stateCached(c)?b._fire("pop",c,b._responses[c]):b._getUrl(c,function(a){b._fire("pop",c,a)})};this._enabled=!0,this._pushable?a.addEventListener("popstate",function(){c()},!1):this._hashable&&a.addEventListener("hashchange",function(){b._ishashpushed?b._ishashpushed=!1:c()},!1)}},a.PushState=c}(window),function(a){"use strict";var b=function(){return this.init.apply(this,arguments)};b.prototype={constructor:b,_rHTTPs:/^http[s]?:\/\/.*?\//,_rTrails:/^\/|\/$/g,_rHashQuery:/#.*$|\?.*$/g,_rWild:/^:num|^:slug|^:any|^:reg/,_wilders:{":slug":/^[A-Za-z0-9-_.]*/,":num":/^[0-9]+$/,":any":/^.*/,":reg":/:reg|\(|\)/g},_routes:null,init:function(a){this._routes=a?this._cleanRoutes(a):[]},config:function(a){return this._routes=this._routes.concat(this._cleanRoutes(a)),this},test:function(a){return this.parse(a,this._routes).match},match:function(a){return this.parse(a,this._routes).matches},compare:function(a,b){return this.parse(b,[a])},parse:function(a,b){for(var c,d,e,f,g,h=this._cleanRoute(a),i=h.split("/"),j=i.length,k=b.length,l={match:!1,matches:[]},m=0;k>m;m++){if(f=b[m].split("/"),"/"===h&&"/"===b[m]){l.match=!0,l.matches.push(b[m]);break}if(f.length===i.length){c=0;for(var n=0;j>n;n++)d=f[n].match(this._rWild),d?(e=d[0],g=":reg"===e?new RegExp(f[n].replace(this._wilders[e],"")):this._wilders[e],g.test(i[n])&&c++):i[n]===f[n]&&c++;if(c===i.length){l.match=!0,l.matches.push(b[m]);break}}}return l},_cleanRoute:function(a){return"/"!==a&&(a=a.replace(this._rHTTPs,""),a=a.replace(this._rTrails,""),a=a.replace(this._rHashQuery,"")),""===a&&(a="/"),a},_cleanRoutes:function(a){for(var b=a.length;b--;)a[b]=this._cleanRoute(a[b]);return a}},a.MatchRoute=b}(window),function(a,b){"use strict";var c=function(){return this.init.apply(this,arguments)};c.prototype={constructor:c,_matcher:new MatchRoute,_pusher:null,_callbacks:{get:[]},_options:{preventDefault:!1},init:function(a){var c=this;a.preventDefault!==b&&(this._options.preventDefault=a.preventDefault),this._pusher=new PushState(a),document.addEventListener?document.addEventListener("click",function(a){c._handler(a)},!1):document.attachEvent&&document.attachEvent("onclick",function(a){c._handler(a)}),setTimeout(function(){c._pusher.onPopState(function(a,b){c._fire("get",a,b)})},1e3)},get:function(a,b){this._matcher.config([a]),b._routes?b._routes.push(a):b._routes=[a],1===b._routes.length&&this._bind("get",b)},_preventDefault:function(a){return this._options.preventDefault?void(a.preventDefault?a.preventDefault():a.returnValue=!1):this},_handler:function(a){var b=this;if("a"===a.target.tagName.toLowerCase()){var c=a.target;-1===c.href.indexOf("#")&&this._matcher.test(c.href)&&(this._preventDefault(a),this._pusher.push(c.href,function(a){b._fire("get",c.href,a)}))}},_bind:function(a,b){this._callbacks[a]&&"function"==typeof b&&this._callbacks[a].push(b)},_fire:function(a,b,c){if(this._callbacks[a])for(var d=this._callbacks[a].length;d--;){var e=this._matcher.parse(b,this._callbacks[a][d]._routes);e.match&&this._callbacks[a][d].call(this,{route:this._matcher._cleanRoute(b),response:c})}}},a.Router=c}(window);