!function(a,b){"use strict";var c=function(){return this.init.apply(this,arguments)};c.prototype={init:function(c){var d=a.location.href;this._rHash=/#/,this._rHTTPs=/^http[s]?:\/\/.*?\//,this._enabled=!1,this._pushable="history"in a&&"pushState"in a.history,this._hashable="onhashchange"in a,this._ishashpushed=!1,this._uid=0,this._states={},this._states[d]={uid:this._getUid(),cached:!1},this._responses={},this._callbacks={pop:[],before:[],after:[]},this._async=c.async!==b?c.async:!0,this._caching=c.caching!==b?c.caching:!0,this._stateEnable()},push:function(a,b){var c=this;this._fire("before"),this._stateCached(a)?(this._push(a),b(this._responses[a])):(this._states[a]={uid:this._getUid(),cached:!1},this._async?this._getUrl(a,function(d){c._push(a),c._fire("after",d),"function"==typeof b&&b(d)}):(this._push(a),this._fire("after"),"function"==typeof b&&b()))},onBeforeState:function(a){this._bind("before",a)},onAfterState:function(a){this._bind("after",a)},onPopState:function(a){this._bind("pop",a)},goBack:function(){this._history.back(),this._fire("back")},goForward:function(){this._history.forward(),this._fire("forward")},_push:function(b){this._pushable?a.history.pushState(this._states[b],"",b):(this._ishashpushed=!0,a.location.hash=b.replace(this._rHTTPs,""))},_stateCached:function(a){var b=!1;return this._caching&&this._states[a]&&this._states[a].cached&&this._responses[a]&&(b=!0),b},_cacheState:function(a,b){this._caching&&(this._states[a].cached=!0,this._responses[a]=b)},_getUid:function(){return this._uid=this._uid+1,this._uid},_getUrl:function(a,b){var c=new XMLHttpRequest,d=this;c.open("GET",a,!0),c.onreadystatechange=function(){if(4===this.readyState&&200===this.status)try{d._cacheState(a,this),"function"==typeof b&&b(this)}catch(c){}},c.send()},_bind:function(a,b){this._callbacks[a]&&"function"==typeof b&&this._callbacks[a].push(b)},_fire:function(a){for(var b=this._callbacks[a].length;b--;)this._callbacks[a][b].apply(this,[].slice.call(arguments,1))},_stateEnable:function(){if(this._enabled)return this;var b=this,c=function(){var c=a.location.href.replace(b._rHash,"/");b._stateCached(c)?b._fire("pop",c,b._responses[c]):b._getUrl(c,function(a){b._fire("pop",c,a)})};this._enabled=!0,this._pushable?a.addEventListener("popstate",function(){c()},!1):this._hashable&&a.addEventListener("hashchange",function(){b._ishashpushed?b._ishashpushed=!1:c()},!1)}},a.PushState=c}(window),function(a){"use strict";var b=function(){return this.init.apply(this,arguments)};b.prototype={_rHTTPs:/^http[s]?:\/\/.*?\//,_rTrails:/^\/|\/$/g,_rHashQuery:/[#|?].*$/g,_rWild:/^:num|^:slug|^:any|^:reg/,_wilders:{":slug":/^[A-Za-z0-9-_.]*/,":num":/^[0-9]+$/,":any":/^.*/,":reg":/:reg|\(|\)/g},init:function(a){this._routes=a?this._cleanRoutes(a):[]},config:function(a){return this._routes=this._routes.concat(this._cleanRoutes(a)),this},test:function(a){return this.parse(a,this._routes).match},match:function(a){return this.parse(a,this._routes).matches},compare:function(a,b){return this.parse(b,[a])},parse:function(a,b){for(var c,d,e,f,g,h=this._cleanRoute(a),i=h.split("/"),j=i.length,k=b.length,l={match:!1,matches:[]},m=0;k>m;m++)if(f=b[m].split("/"),f.length===i.length){c=0;for(var n=0;j>n;n++)d=f[n].match(this._rWild),d?(e=d[0],g=":reg"===e?new RegExp(f[n].replace(this._wilders[e],"")):this._wilders[e],g.test(i[n])&&c++):i[n]===f[n]&&c++;if(c===i.length){l.match=!0,l.matches.push(b[m]);break}}return l},_cleanRoute:function(a){return a=a.replace(this._rHTTPs,""),a=a.replace(this._rTrails,""),a=a.replace(this._rHashQuery,"")},_cleanRoutes:function(a){for(var b=a.length;b--;)a[b]=this._cleanRoute(a[b]);return a}},a.MatchRoute=b}(window),function(a){"use strict";var b=function(){return this.init.apply(this,arguments)};b.prototype={init:function(a){var b=this;this._matcher=new MatchRoute,this._pusher=new PushState(a),this._callbacks={get:[]},this._handler=function(a){if("a"===a.target.tagName.toLowerCase()){var c=a.target;-1===c.href.indexOf("#")&&b._matcher.test(c.href)&&b._pusher.push(c.href,function(a){b._fire("get",c.href,a)})}},document.addEventListener?document.addEventListener("click",this._handler,!1):document.attachEvent("onclick",this._handler),setTimeout(function(){b._pusher.onPopState(function(a,c){b._fire("get",a,c)})},1e3)},get:function(a,b){this._matcher.config([a]),b._route=a,this._bind("get",b)},_bind:function(a,b){this._callbacks[a]&&"function"==typeof b&&this._callbacks[a].push(b)},_fire:function(a,b,c){if(this._callbacks[a])for(var d=this._callbacks[a].length;d--;){var e=this._matcher.compare(this._callbacks[a][d]._route,b);e.match&&this._callbacks[a][d].call(this,{route:this._matcher._cleanRoute(b),response:c})}}},a.Router=b}(window);