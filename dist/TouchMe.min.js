!function(a,b){"use strict";var c=null,d=function(){return c||this.init.apply(this,arguments)};d.prototype={constructor:d,init:function(a){var d=this;c=this,this._touches={},this._tapTimeout=null,this._tapList=[],this._gestures=[],this._handlers={},this._lastSwipe="",this._lastTouch=0,this._tapStart=null,this._windowScrollY=0,this._isTouchDown=!1,this._multiOriginDistance=0,this._options={preventDefault:!0,preventMouseEvents:!1,touchThreshold:60,touchHoldThreshold:300,touchPinchThreshold:150,touchPullThreshold:150,touchDoubleTapThreshold:300},this._uid=0;for(var e in this._options)a&&typeof a[e]!==b&&(this._options[e]=a[e]);document.addEventListener("touchstart",function(a){d._onTouchStart(this,a)},!1),document.addEventListener("touchmove",function(a){d._onTouchMove(this,a)},!1),document.addEventListener("touchend",function(a){d._onTouchEnd(this,a)},!1),this._options.preventMouseEvents||(document.addEventListener("mousedown",function(a){d._onTouchStart(this,a)},!1),document.addEventListener("mousemove",function(a){d._onTouchMove(this,a)},!1),document.addEventListener("mouseup",function(a){d._onTouchEnd(this,a)},!1))},on:function(a,b,c){"function"==typeof c&&(this._handlers[a]||(this._handlers[a]=[]),c._touchmeID=this.getUID(),c._touchmeSelector=b,c._touchmeEvent=a,this._handlers[a].push(c))},off:function(a,b){if(!this._handlers[a])return this;for(var c=0,d=this._handlers[a].length;d>c;c++)if(b._touchmeID===this._handlers[a][c]._touchmeID){this._handlers[a].splice(c,1);break}},getUID:function(){return this._uid=this._uid+1,this._uid},getSwipe:function(a,b,c,d){var e,f=Math.abs(a-b),g=Math.abs(c-d);return e=f>=g?a-b>0?"left":"right":c-d>0?"up":"down"},getSwipeAngle:function(a,b,c,d){var e,f=c-d,g=a-b;return e=Math.atan2(f,g),e*=180/Math.PI},getDistance:function(a,b){var c=a.pageX-b.pageX,d=a.pageY-b.pageY;return Math.sqrt(c*c+d*d)},isDelegate:function(a,b){return this._matchElement(a.target,b)},is45ish:function(a){return a=Math.abs(a),180>a&&a>135||a>0&&45>a},_call:function(a,b,c){if(!this._handlers[a])return this;for(var d=this._handlers[a].length;d--;){var e=this.isDelegate(c,this._handlers[a][d]._touchmeSelector);e&&this._handlers[a][d].call(e,c)}},_isDelegated:function(a){var b=null;for(var c in this._handlers)for(var d=this._handlers[c].length;d--&&!(b=this.isDelegate(a,this._handlers[c][d]._touchmeSelector)););return b},_matchElement:function(a,b){var c=a.matches?"matches":a.webkitMatchesSelector?"webkitMatchesSelector":a.mozMatchesSelector?"mozMatchesSelector":a.msMatchesSelector?"msMatchesSelector":a.oMatchesSelector?"oMatchesSelector":null;return c&&a[c].call(a,b)?a:a!==document.documentElement&&a.parentNode?this._matchElement(a.parentNode,b):null},_onTouchStart:function(b,c){return this._isTouchDown=!0,this._gestures=[],this._lastSwipe="",this._tapStart=Date.now(),this._windowScrollY=a.scrollY,c.touches&&c.touches.length>1?this._onMultiTouchStart(b,c):void(c.touches?(this._lastTouch=c.touches.length-1,this._touches.x0=c.touches[this._lastTouch].pageX,this._touches.y0=c.touches[this._lastTouch].pageY,this._touches.x1=c.touches[this._lastTouch].pageX,this._touches.y1=c.touches[this._lastTouch].pageY):(this._lastTouch=0,this._touches.x0=c.pageX,this._touches.y0=c.pageY,this._touches.x1=c.pageX,this._touches.y1=c.pageY))},_onTouchMove:function(a,b){if(this._isTouchDown){if(b.touches&&b.touches.length>1)return this._onMultiTouchMove(a,b);var c,d,e,f;if(b.touches?(this._touches.x2=b.touches[this._lastTouch].pageX,this._touches.y2=b.touches[this._lastTouch].pageY):(this._touches.x2=b.pageX,this._touches.y2=b.pageY),e=Math.abs(this._touches.x1-this._touches.x2),f=Math.abs(this._touches.y1-this._touches.y2),c=this.getSwipeAngle(this._touches.x0,this._touches.x2,this._touches.y0,this._touches.y2),("left"===d||"right"===d)&&this._isDelegated(b)&&this.is45ish(c)&&this._options.preventDefault&&b.preventDefault(),e>this._options.touchThreshold||f>this._options.touchThreshold){if(d=this.getSwipe(this._touches.x1,this._touches.x2,this._touches.y1,this._touches.y2),this._touches.x1=this._touches.x2,this._touches.y1=this._touches.y2,d===this._lastSwipe)return;this._lastSwipe=d,this._gestures.push("swipe"+d)}this._call("touchmove",a,b)}},_onTouchEnd:function(a,b){this._isTouchDown=!1;var d=function(){b.gestures=c._gestures;for(var d=0,e=c._gestures.length;e>d;d++)c._call("touch"+c._gestures[d],a,b)};try{clearTimeout(this._tapTimeout)}catch(e){}this._gestures.length?d():(this._tapList.push({start:this._tapStart,ended:Date.now()}),this._tapTimeout=setTimeout(function(){Date.now()-c._tapStart>=c._options.touchHoldThreshold?(console.log("cancel tap"),c._tapList=[]):2===c._tapList.length&&c._tapList[1].start-c._tapList[0].ended<=c._options.touchDoubleTapThreshold?(-1===c._gestures.indexOf("doubletap")&&c._gestures.push("doubletap"),c._tapList=[],d()):1===c._tapList.length&&Date.now()-c._tapStart>=c._options.touchThreshold&&(-1===c._gestures.indexOf("tap")&&c._gestures.push("tap"),c._tapList=[],d())},this._options.touchThreshold))},_onMultiTouchStart:function(a,b){2===b.touches.length&&(this._multiOriginDistance=this.getDistance(b.touches[0],b.touches[1]))},_onMultiTouchMove:function(a,b){if(2===b.touches.length){var c=this.getDistance(b.touches[0],b.touches[1]);if(c<this._multiOriginDistance){var d=Math.abs(this._multiOriginDistance-c);d>=this._options.touchPinchThreshold&&-1===this._gestures.indexOf("pinch")&&this._gestures.push("pinch")}else{var e=Math.abs(c-this._multiOriginDistance);e>=this._options.touchPullThreshold&&-1===this._gestures.indexOf("pull")&&this._gestures.push("pull")}}}},a.TouchMe=d}(window);