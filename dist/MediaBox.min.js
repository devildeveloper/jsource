!function(a){"use strict";var b={linear:function(a){return a},swing:function(a){return(1-Math.cos(a*Math.PI))/2},easeInQuad:function(a){return a*a},easeOutQuad:function(a){return a*(2-a)},easeInOutQuad:function(a){return.5>a?2*a*a:-1+(4-2*a)*a},easeInCubic:function(a){return a*a*a},easeOutCubic:function(a){return--a*a*a+1},easeInOutCubic:function(a){return.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},easeInQuart:function(a){return a*a*a*a},easeOutQuart:function(a){return 1- --a*a*a*a},easeInOutQuart:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},easeInQuint:function(a){return a*a*a*a*a},easeOutQuint:function(a){return 1+--a*a*a*a*a},easeInOutQuint:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}};a.Easing=b}(window),function(a){"use strict";var b=function(a,b,c,d,e){function f(){var a=new Date-j,k=i*e(a/h)+b;return a>h?(d(c),cancelAnimationFrame(g),g=null,!1):(d(k),void(g=requestAnimationFrame(f)))}e=e||function(a){return a};var g,h=a||1e3,i=c-b,j=new Date;f()};a.Tween=b}(window),function(a){"use strict";var b=function(){return this.init.apply(this,arguments)};b.prototype={constructor:b,STATE_STOPPED:0,STATE_STOPPING:1,STATE_PAUSED:2,STATE_PLAYING:3,init:function(){this._supported={},this._supported.audio=this._getAudioSupport(),this._supported.video=this._getVideoSupport(),this._channels={},this._audio={},this._video={},this._audioPaused=!1},createAudioContext:function(){return a.AudioContext?new AudioContext:a.webkitAudioContext?new webkitAudioContext:!1},createGainNode:function(a){return a.createGain?a.createGain():a.createGainNode()},loadMedia:function(a,b){var c=new XMLHttpRequest,d=this;c.open("GET",a,!0),c.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a;try{a=JSON.parse(this.responseText)}catch(c){}a&&d.addMedia(a,b)}},c.send()},addMedia:function(a,b){var c=0,d=0;for(var e in a){d+=a[e].length;for(var f=a[e].length;f--;)this[e](a[e][f],function(){c++,"function"==typeof b&&c===d&&b()})}},addVideo:function(a,b){var c=this,d=a[0],e=new XMLHttpRequest;this._channels[a[2].channel]||(this._channels[a[2].channel]={}),this._video[d]={},this._video[d].channel=a[2].channel,this._video[d].loop=a[2].loop||!1,this._video[d].sources=a[1],this._video[d].element=document.createElement("video"),this._video[d].element.setAttribute("controls",!1),this._video[d].useSource=this._getUsedMediaSource("video",this._video[d].sources),this._video[d]._events={},e.open("GET",a[1][0],!0),e.onload=function(){for(var a=c._video[d].sources.length;a--;){var e=document.createElement("source");e.src=c._video[d].sources[a],e.type=c._getMimeFromMedia(c._video[d].sources[a]),c._video[d].element.appendChild(e)}"function"==typeof b&&b()},e.send()},addVideoEvent:function(a,b,c){this._video[a]&&(this._video[a]._events[b]=function(){"function"==typeof c&&c.apply(this,arguments)},this._video[a].element.addEventListener(b,this._video[a]._events[b],!1))},removeVideoEvent:function(a,b){this._video[a]&&(this._video[a].element.removeEventListener(b,this._video[a]._events[b],!1),this._video[a]._events[b]=null)},getVideo:function(a){return this._video[a].element},playVideo:function(a){this._video[a]&&(this._video[a].element.volume=this._channels[this._video[a].channel].volume,this._video[a].element.play())},stopVideo:function(a){this._video[a]&&this._video[a].element.pause()},addAudio:function(a,b){var c=this,d=a[0],e=new XMLHttpRequest;this._channels[a[2].channel]||(this._channels[a[2].channel]={}),this._audio[d]={},this._audio[d].channel=a[2].channel,this._audio[d].loop=a[2].loop||!1,this._audio[d].sources=a[1],this._audio[d].context=this.createAudioContext(),this._audio[d].useSource=this._getUsedMediaSource("audio",this._audio[d].sources),this._audio[d].state=this.STATE_STOPPED,e.open("GET",this._audio[d].useSource,!0),e.responseType="arraybuffer",e.onload=function(){c._audio[d].context.decodeAudioData(e.response,function(a){c._audio[d].startTime=0,c._audio[d].startOffset=0,c._audio[d].buffer=a,c._audio[d].gainNode=c.createGainNode(c._audio[d].context),"function"==typeof b&&b()})},e.send()},playAudio:function(a){this._audio[a]&&(this._audio[a].startTime=this._audio[a].context.currentTime,this._audio[a].source=this._audio[a].context.createBufferSource(),this._audio[a].source.buffer=this._audio[a].buffer,this._audio[a].source.connect(this._audio[a].gainNode),this._audio[a].gainNode.connect(this._audio[a].context.destination),this._audio[a].gainNode.gain.value=this._channels[this._audio[a].channel].volume||1,this._audio[a].loop&&(this._audio[a].source.loop=!0),this._sourceStart(this._audio[a]),this._audio[a].state=this.STATE_PLAYING)},hitAudio:function(a){this.playAudio(a)},stopAudio:function(a){this._audio[a]&&(this._audio[a].startTime=0,this._audio[a].startOffset=0,this._audio[a].state=this.STATE_STOPPED,this._sourceStop(this._audio[a]))},pauseAudio:function(a){this._audio[a]&&(this._audio[a].startOffset+=this._audio[a].context.currentTime-this._audio[a].startTime,this._audio[a].state=this.STATE_PAUSED,this._sourceStop(this._audio[a]))},fadeAudioIn:function(a,b){if(this._audio[a].state===this.STATE_PLAYING)return this;var c=this,d=this._channels[this._audio[a].channel].volume;this._audio[a]&&(this._audio[a].state===this.STATE_STOPPED?(this._audio[a].gainNode.gain.value=0,this.playAudio(a)):this._audio[a].state===this.STATE_STOPPING&&(this._audio[a].state=this.STATE_PLAYING),new Tween(b||1e3,0,d,function(b){c._audio[a].gainNode.gain.value=b}))},fadeAudioOut:function(a,b){if(this._audio[a].state===this.STATE_STOPPING)return this;var c=this;this._audio[a]&&(this._audio[a].state=this.STATE_STOPPING,new Tween(b||1e3,this._audio[a].gainNode.gain.value,0,function(b){c._audio[a].state===c.STATE_STOPPING&&(c._audio[a].gainNode.gain.value=b,0===c._audio[a].gainNode.gain.value&&c.stopAudio(a))}))},stopChannel:function(a){for(var b in this._audio)this._audio[b].channel===a&&this._audio[b].state===this.STATE_PLAYING&&this.pauseAudio(b)},playChannel:function(a){for(var b in this._audio)this._audio[b].channel===a&&this._audio[b].state===this.STATE_PAUSED&&this.playAudio(b)},fadeChannelOut:function(a,b){for(var c in this._audio)this._audio[c].channel===a&&this._audio[c].state===this.STATE_PLAYING&&this.fadeAudioOut(c,b)},fadeChannelIn:function(a,b){for(var c in this._audio)this._audio[c].channel===a&&this._audio[c].state===this.STATE_PAUSED&&this.fadeAudioIn(c,b)},crossFadeChannel:function(a,b,c){for(var d in this._audio)this._audio[d].channel===a&&this._audio[d].state===this.STATE_PLAYING&&this.fadeAudioOut(d,c);this.fadeAudioIn(b,c)},setChannelVolume:function(a,b){this._channels[a]&&(this._channels[a].volume=b)},pauseAll:function(a){if(this._audioPaused)return this;this._audioPaused=!0;for(var b in this._audio)this._audio[b].state===this.STATE_PLAYING&&this._audio[b].channel===a&&this.pauseAudio(b)},resumeAll:function(a){if(!this._audioPaused)return this;this._audioPaused=!1;for(var b in this._audio)this._audio[b].state===this.STATE_PAUSED&&this._audio[b].channel===a&&this.playAudio(b)},_sourceStart:function(a){a.source.start?a.source.start(0,a.startOffset%a.buffer.duration):a.source.noteOn(0,a.startOffset%a.buffer.duration)},_sourceStop:function(a){a.source.stop?a.source.stop(0):a.source.noteOff(0)},_getMimeFromMedia:function(a){var b;switch(a.split(".").pop().toLowerCase()){case"ogg":b="audio/ogg";break;case"mp3":b="audio/mpeg";break;case"webm":b="video/webm";break;case"mp4":b="video/mp4";break;case"ogv":b="video/ogg"}return b},_getUsedMediaSource:function(a,b){for(var c,d=b.length;d--;){var e=b[d].split(".").pop().toLowerCase();if("probably"===this._supported[a][e]){c=b[d];break}}return c},_getAudioSupport:function(){var a=document.createElement("audio"),b=!1,c=/^no$/;try{(b=!!a.canPlayType)&&(b=new Boolean(b),b.ogg=a.canPlayType('audio/ogg; codecs="vorbis"').replace(c,""),b.mp3=a.canPlayType("audio/mpeg;").replace(c,""),b.wav=a.canPlayType('audio/wav; codecs="1"').replace(c,""),b.m4a=(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")).replace(c,""))}catch(d){}return b},_getVideoSupport:function(){var a=document.createElement("video"),b=!1,c=/^no$/;try{(b=!!a.canPlayType)&&(b=new Boolean(b),b.ogg=a.canPlayType('video/ogg; codecs="theora"').replace(c,""),b.h264=a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(c,""),b.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(c,""))}catch(d){}return b}},a.MediaBox=b}(window);